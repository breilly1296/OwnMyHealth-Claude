# ═══════════════════════════════════════════════════════════════════════════════
# OwnMyHealth Backend Environment Configuration
# ═══════════════════════════════════════════════════════════════════════════════
#
# Copy this file to .env and update the values for your environment.
# NEVER commit .env to version control!
#
# For production, all variables marked [REQUIRED IN PRODUCTION] must be set
# to secure, unique values.
#
# ═══════════════════════════════════════════════════════════════════════════════

# ───────────────────────────────────────────────────────────────────────────────
# Server Configuration
# ───────────────────────────────────────────────────────────────────────────────

# Environment: development | production | test
NODE_ENV=development

# Server port (default: 3001)
PORT=3001

# ───────────────────────────────────────────────────────────────────────────────
# Database Configuration
# ───────────────────────────────────────────────────────────────────────────────

# [REQUIRED IN PRODUCTION] PostgreSQL connection string
# For local Prisma Postgres development, run: npx prisma dev
# For production, use your PostgreSQL server URL
DATABASE_URL="prisma+postgres://localhost:51213/?api_key=YOUR_API_KEY"

# ───────────────────────────────────────────────────────────────────────────────
# JWT Authentication
# ───────────────────────────────────────────────────────────────────────────────

# [REQUIRED IN PRODUCTION] JWT Access Token Secret
# Generate with: openssl rand -base64 32
# Short-lived access token (15 minutes default)
JWT_ACCESS_SECRET=access-secret-change-in-production

# Access token expiration (default: 15m)
JWT_ACCESS_EXPIRES_IN=15m

# [REQUIRED IN PRODUCTION] JWT Refresh Token Secret
# Generate with: openssl rand -base64 32
# Long-lived refresh token (7 days default)
JWT_REFRESH_SECRET=refresh-secret-change-in-production

# Refresh token expiration (default: 7d)
JWT_REFRESH_EXPIRES_IN=7d

# Legacy JWT settings (deprecated, use ACCESS/REFRESH above)
# JWT_SECRET=
# JWT_EXPIRES_IN=

# ───────────────────────────────────────────────────────────────────────────────
# PHI Encryption (Protected Health Information)
# ───────────────────────────────────────────────────────────────────────────────

# [REQUIRED IN PRODUCTION] PHI Encryption Key
# CRITICAL: This key is used to encrypt all Protected Health Information (PHI)
#
# Requirements:
#   - Must be at least 64 hexadecimal characters (256 bits)
#   - Must contain only valid hex characters (0-9, a-f, A-F)
#   - Must NOT be a placeholder/test key in production
#
# Generate a secure key with:
#   openssl rand -hex 32
#
# IMPORTANT: Store this key securely! If lost, all encrypted PHI data becomes
# unrecoverable. Consider using a secrets manager in production.
#
# Example (DO NOT USE THIS IN PRODUCTION):
PHI_ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# ───────────────────────────────────────────────────────────────────────────────
# Account Security
# ───────────────────────────────────────────────────────────────────────────────

# Maximum failed login attempts before account lockout (default: 5)
MAX_LOGIN_ATTEMPTS=5

# Account lockout duration in minutes (default: 30)
LOCKOUT_DURATION_MINUTES=30

# Bcrypt hashing rounds (default: 12, higher = more secure but slower)
# Recommended: 12 for most cases, 14+ for high-security environments
BCRYPT_ROUNDS=12

# ───────────────────────────────────────────────────────────────────────────────
# CORS (Cross-Origin Resource Sharing)
# ───────────────────────────────────────────────────────────────────────────────

# Allowed origin for CORS requests
# In development, multiple localhost ports are allowed by default
# In production, set to your frontend domain (e.g., https://app.example.com)
# CORS_ORIGIN=https://app.example.com

# ───────────────────────────────────────────────────────────────────────────────
# Cookie Configuration
# ───────────────────────────────────────────────────────────────────────────────

# Cookie SameSite policy: strict | lax | none
# Default: lax in development, strict in production
# COOKIE_SAME_SITE=strict

# Cookie domain (for cross-subdomain cookies)
# COOKIE_DOMAIN=.example.com

# ───────────────────────────────────────────────────────────────────────────────
# Rate Limiting
# ───────────────────────────────────────────────────────────────────────────────

# Rate limit window in milliseconds (default: 900000 = 15 minutes)
RATE_LIMIT_WINDOW_MS=900000

# Maximum requests per window (default: 100)
RATE_LIMIT_MAX_REQUESTS=100

# ───────────────────────────────────────────────────────────────────────────────
# Demo Account (Development Only)
# ───────────────────────────────────────────────────────────────────────────────

# Demo account password - CHANGE THIS in any shared/deployed environment!
# Demo mode is automatically disabled in production (NODE_ENV=production)
# Generate a new password with: openssl rand -base64 16
DEMO_PASSWORD=Demo123!

# ───────────────────────────────────────────────────────────────────────────────
# External APIs (for future use)
# ───────────────────────────────────────────────────────────────────────────────

# OpenAI API Key (for AI-powered health insights)
# OPENAI_API_KEY=your-openai-api-key

# ═══════════════════════════════════════════════════════════════════════════════
# Production Checklist
# ═══════════════════════════════════════════════════════════════════════════════
#
# Before deploying to production, ensure you have:
#
# [ ] Set NODE_ENV=production
# [ ] Set DATABASE_URL to your production PostgreSQL
# [ ] Generated and set JWT_ACCESS_SECRET (openssl rand -base64 32)
# [ ] Generated and set JWT_REFRESH_SECRET (openssl rand -base64 32)
# [ ] Generated and set PHI_ENCRYPTION_KEY (openssl rand -hex 32)
# [ ] Set CORS_ORIGIN to your frontend domain
# [ ] Configured HTTPS/TLS for your server
# [ ] Set up proper secrets management (e.g., AWS Secrets Manager, HashiCorp Vault)
# [ ] Backed up your PHI_ENCRYPTION_KEY securely (data recovery depends on it!)
#
# ═══════════════════════════════════════════════════════════════════════════════
